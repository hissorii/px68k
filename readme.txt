ポータブルX68000エミュレータ
PX68K ( Portable (x)keropi PRO-68K )
                                                                     2013/09/04

いろいろなデバイスで X68000 エミュレータが動作したら楽しいな、
と思い立ち、この PX68K を作りはじめました。

「Portable」とは「移植しやすいよ」という意味です。
タブレットや PSP 等のポータブルデバイスで動いたらいいな、
という意味もこめています。


PX68K は以下の成分からできています。

  けんじょさん (http://retropc.net/kenjo/) が
  作成された SHARP X68000エミュレータ WinX68k (通称けろぴー)

  NONAKA Kimihiro さん(http://www.asahi-net.or.jp/~aw9k-nnk/keropi/) が
  けろぴーを UNIX/X11 環境で動作する様に移植した xkeropi

  Stephane Dallongeville さんが開発したものを、
  NJ氏が PSP 用 CPS1/CPS2/MVSP/NCDZ に組み込んだ MC68000 MPU エミュレータ

  cisc氏(cisc@retropc.net)が作成された FM/PSG 音源実装 fmgen
  (詳細は ソースリポジトリの fmgen/readme.txt を参照)
  PX68K への実装にあたり、以下の変更を行っています
  ・Sample 型を int32 から int16 に変更
  ・PSP 用に 11k, 22k から 44k データ作成ロジックを追加


0. 注意事項

  0.1 全機種共通

  とりあえず GTK/X11 用に作られていたメニューやらキー入力やらは
  全部取っ払ったので、今のところそれらはないです。
  Joystick 対応を行ったので多少遊べる様になったかもしれません。

  0.2 Android 版について

  Android 2.3.3以上でないと動きません。

  0.3 PSP 版について

  CFW を導入していないと動きません。


1. 下準備

  ・BIOS ROM ファイルを用意してください。
    ファイル名は以下のいずれかで、小文字でも大文字でも構いません。

        iplrom.dat, iplrom30.dat, iplromco.dat, iplromxv.dat

  ・フォントファイルを用意してください。
    ファイル名は以下のいずれかで、小文字でも大文字でも構いません。

        cgrom.dat, cgrom.tmp

    フォントファイルがない場合は PC 上で WinX68k 高速版を実行すると、
    cgrom.tmp が生成されますので、それを使ってください。

  ・メモリ設定を 2MB にしたい場合は、PC 上の winx68k(keropi) や
    WinX68k 高速版で HUMAN68K の SWITCH.X コマンドを起動、設定してください。
    現在エミュレータ側でメモリ上限を 2MB にしていますので、それより
    大きな値を SWITCH.X で設定しないでください。

    PC 上のエミュレータを終了すると、sram.dat ファイルが生成されるので、
    それを本エミュレータの BIOS ROM と同じディレクトリにコピーしてください。

    Human68K は立ち上がるけれど、ゲームが起動できない場合は標準のメモリ 1MB
    では動作しないゲームである可能性が高いです。
    (本処置は px68k で仮想キーボードが実装されるまでの暫定処置です)


2. Android 版について

  2.1 ファイルの配置について

   ・/sdcard/px68k/ ディレクトリを作成し、BIOS ROM, フォントファイルを置く

     エミュレータを開始してもすぐに終了してしまう場合は、これらのファイルの
     置き場所、ファイル名について見直してみてください。

  2.2 イメージファイルについて

  ・FD 一枚目として読み込みたいイメージファイルを FDD1.XDF として、
    /sdcard/px68k/ ディレクトリに置く。
    FD 二枚目の場合は FDD2.XDF として置く。
    (本処置は px68k で UI が実装されるまでの暫定処置です)

  2.3 ジョイスティック

  ・画面左側の D-pad っぽいのでスティック移動、画面右側のボタンっぽいのが
    トリガー1, 2に対応します。

  2.4 キーボード

  ・未実装

  2.5 サウンド出力

  ・サンプリング周波数は 22050Hz 固定です。
    今のところ config に書いた値は反映されません。UI 実装時に考えます。
    現在 ADPCM と OPM のみ対応済みで、マーキュリーユニット、MIDI については
    未対応です。

  2.6 エミュレータの終了

  ・バックキー(戻るキー)を2回タップしてください。


3. PSP 版について

  3.1 ファイルの配置について

  ・EBOOT.PBP と同じディレクトリに .keropi というディレクトリを作成し、
    BIOS ROM, フォントファイルを置く

  3.2 イメージファイルについて

  ・FDD 一枚目として読み込みたいイメージファイルを FDD1.XDF として、
    EBOOT.PBP と同じディレクトリに置く。
    FDD 二枚目の場合は FDD2.XDF として置く。
    (本処置は px68k で UI が実装されるまでの暫定処置です)

  3.3 ジョイスティック

  ・D-pad でスティック移動、○ボタン、×ボタンがトリガー1, 2に対応します。

  3.4 キーボード

  ・未実装

  3.5 サウンド出力

  ・PSP は今のところサンプリング周波数が 11025Hz 固定です。


4. Unix 版について

  4.1 ファイルの配置について

  ・~/.keropi に BIOS ROM、フォントファイルを置いてください。

  4.2 イメージファイルについて

  ・引数で指定します。最初が FDD1, 次が FDD2 。

    $ ./xkeropi hoge.xdf hogege.xdf

  4.3 ジョイスティック

  ・JoyKey モードを有効にすると、キーボードのカーソルキーでスティック移動、
    z キー、x キーがそれぞれトリガー 1, 2 に対応します。
    現在UIがないため、~/.keropi/configをエディタで修正する必要がある。

  4.4 キーボード

  ・アルファベットキーやリターンキー等、ある程度のキーに対応。
    全てのテーブルをまだ書き換えていないので中途半端です。

  4.5 サウンド出力

  ・サンプリング周波数は 22050Hz 固定です。
    今のところ config に書いた値は反映されません。UI 実装時に考えます。
    現在 ADPCM と OPM のみ対応済みで、マーキュリーユニット、MIDI については
    未対応です。


7. その他

  7.1 X68000 のメインメモリ
  ・現在 2MB にしています。
  7.2 キー入力できないのですが?
  7.3 PSP で実行すると動作がものすごく遅いんですけど?
  7.4 説明の番号が4から7に飛んでるんですけど?

      -> とりあえず現状はそんなものです。すみません。


8. 履歴

   2013/08/02 PSP版Ver0.00リリース
   2013/08/07 Android版Ver0.00リリース
   2013/08/12 256x256, 512x512の場合に画面比率4:3になるように修正 (Unix)
   2013/08/12 256x256画面を横2.666倍、縦2倍の拡大表示に変更 (Unix)
   2013/08/12 画面描写をOpenGL ES 1.1を使用する様に変更 (Android)
   2013/08/17 画面描写をHW Graphics Engineを使用する様に変更 (PSP)
   2013/08/19 ジョイスティックのサポートを追加 (PSP)
   2013/08/20 PSP版Ver.0.01リリース
   2013/08/21 画面タッチによるジョイスティックのサポートを追加 (Android)
   2013/08/22 Android版Ver0.01リリース
   2013/08/29 サウンド出力の追加 (Unix, Android)
   2013/08/29 Android版Ver0.02リリース
   2013/08/30 プチノイズの原因となる、サウンドバッファのunderrunが
              発生しないよう修正 (common)
   2013/08/30 CPUクロックを222MHzから333Mhzに変更 (PSP)
   2013/08/30 サウンド出力の追加 (PSP)
   2013/08/31 PSP版Ver0.02リリース
   2013/09/03 戻るボタン、メニューボタンでクラッシュするのを修正
                                              (Android, thanks to @173210)
   2013/09/03 常に横向き(landscape)固定に変更 (Android, thanks to @173210)
   2013/09/04 スリープするとエミュレータが異常終了する問題を修正
                                              (Android, thanks to @173210)
   2013/09/04 バックキー2回タップでエミュレータを終了する様に変更 (Android)
   2013/09/04 機種により仮想キーが効かない問題を修正 (Android)
   2013/09/04 Android版ver0.03リリース


9. 免責

  本ソフトウェアを使用したことによる、いかなる損害も作者は責任を負いません。
  あくまでも自己責任での使用をお願い致します。


ひっそりぃ(hissorii)/sakahi
http://hissorii.blog45.fc2.com (ひっそりぃドットコム)
http://emuhani.seesaa.net      (えみゅはに - Emulator Hacking 日記)
GitHub: https://github.com/hissorii/px68k
Twitter: @hissorii_com
